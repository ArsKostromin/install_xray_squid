# üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Xray + Squid —Å TLS

–°–∫—Ä–∏–ø—Ç —Å—Ç–∞–≤–∏—Ç –≥–æ—Ç–æ–≤—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä —Å Xray (VLESS+WS+TLS) –∏ Squid. –í—Å—ë –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–µ: –æ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è TLS-—Å–µ—Ä—Ç–∞ –¥–æ –∑–∞–ø—É—Å–∫–∞ systemd-—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞.

## üßæ –ß—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

- ‚úÖ **Xray** —Å VLESS over WebSocket + TLS
- ‚úÖ **Squid** –Ω–∞ `127.0.0.1:8888` —Å HTTP Basic Auth (`htpasswd`)
- ‚úÖ **Let's Encrypt TLS** —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —á–µ—Ä–µ–∑ `certbot`
- ‚úÖ **Cron** –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚úÖ **–õ–æ–≥–∏** Xray –∏ Squid

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–°–∫—Ä–∏–ø—Ç —Å–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å—ë –Ω—É–∂–Ω–æ–µ —á–µ—Ä–µ–∑ `apt`, –≤—Ä—É—á–Ω—É—é —Å—Ç–∞–≤–∏—Ç—å –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ.

---

## ‚öôÔ∏è –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. **–£–±–µ–¥–∏—Å—å, —á—Ç–æ:**

   - –£ —Ç–µ–±—è –µ—Å—Ç—å **–¥–æ–º–µ–Ω**, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞ (A-–∑–∞–ø–∏—Å—å —Ä–∞–±–æ—Ç–∞–µ—Ç)
   - –ü–æ—Ä—Ç—ã **80 –∏ 443 —Å–≤–æ–±–æ–¥–Ω—ã** (–∏–Ω–∞—á–µ `certbot` –Ω–µ –ø–æ–ª—É—á–∏—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)

2. **–°–∫–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –∑–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç:**

   ```bash
   git clone https://github.com/ArsKostromin/install_xray_squid.git
   cd xray-squid-auto
   chmod +x install_xray_squid.sh
   ./install_xray_squid.sh example.com
   ```

   –ó–∞–º–µ–Ω–∏ `example.com` –Ω–∞ —Å–≤–æ–π –¥–æ–º–µ–Ω.

3. **–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏** —Ç—ã —É–≤–∏–¥–∏—à—å –∫–æ–Ω—Ñ–∏–≥-—Å—Å—ã–ª–∫—É:

   ```
   vless://<UUID>@<domain>:443?encryption=none&security=tls&type=ws&host=<domain>&path=%2Fws#user-XXXXXX
   ```

---

## üõ† –ì–¥–µ —á—Ç–æ –ª–µ–∂–∏—Ç

| –ß—Ç–æ                     | –ü—É—Ç—å                                      |
|--------------------------|-------------------------------------------|
| –ö–æ–Ω—Ñ–∏–≥ Xray              | `/usr/local/etc/xray/config.json`         |
| –õ–æ–≥–∏ Xray                | `/var/log/xray/access.log`, `error.log`   |
| –ö–æ–Ω—Ñ–∏–≥ Squid             | `/etc/squid/squid.conf`                   |
| –ü–∞—Ä–æ–ª–∏ –¥–ª—è Squid         | `/etc/squid/passwd`                       |
| TLS-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã          | `/etc/letsencrypt/live/<domain>/`         |
| Cron –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è  | `/etc/cron.daily/renew-cert.sh`           |

---

## üßØ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

| –ü—Ä–æ–±–ª–µ–º–∞                                | –†–µ—à–µ–Ω–∏–µ                                                |
|-----------------------------------------|---------------------------------------------------------|
| `certbot` –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç        | –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø–æ—Ä—Ç 80 –æ—Ç–∫—Ä—ã—Ç –∏ DNS –Ω–∞—Å—Ç—Ä–æ–µ–Ω             |
| Xray –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç                        | `journalctl -u xray -xe` –∏–ª–∏ `systemctl status xray`   |
| Squid —Ä—É–≥–∞–µ—Ç—Å—è                          | `journalctl -u squid -xe` –∏ –ø—Ä–æ–≤–µ—Ä—å —Ñ–∞–π–ª `passwd`      |
| TLS-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è           | –ó–∞–ø—É—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é: `certbot renew --dry-run`             |

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Squid —Å–ª—É—à–∞–µ—Ç **—Ç–æ–ª—å–∫–æ localhost**
- –í–µ—Å—å –≤–Ω–µ—à–Ω–∏–π —Ç—Ä–∞—Ñ–∏–∫ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ **TLS (443)**
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ **UUID + –ø–∞—Ä–æ–ª—é**
- –ö–æ–Ω—Ñ–∏–≥–∏ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø—É–±–ª–∏—á–Ω–æ

---

## ü§ò –ê–≤—Ç–æ—Ä

–°–∫—Ä–∏–ø—Ç —Å–¥–µ–ª–∞–Ω —Å –ª–µ–Ω—å—é, –±–æ–ª—å—é –∏ –Ω–µ–Ω–∞–≤–∏—Å—Ç—å—é –∫ —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ. –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞. –ò–ª–∏ —Å–æ –≤—Ç–æ—Ä–æ–≥–æ.

---

## üêâ –ü—Ä–∏–º–µ—Ä —Å—Å—ã–ª–∫–∏ VLESS

```
vless://UUID@domain.com:443?encryption=none&security=tls&type=ws&host=domain.com&path=%2Fws#user-abcdef
```

